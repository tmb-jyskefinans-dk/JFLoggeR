<div class="min-h-screen bg-gradient-to-b from-white to-slate-50 dark:from-slate-900 dark:to-slate-950 text-slate-800 dark:text-slate-100 selection:bg-indigo-200 dark:selection:bg-indigo-500/40 transition-colors duration-300">
  <header class="sticky top-0 z-20 border-b border-slate-200 dark:border-slate-700 bg-white/80 dark:bg-slate-900/70 backdrop-blur shadow-sm">
    <window-controls />
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center gap-4">
  <h1 class="text-lg md:text-xl font-semibold tracking-tight text-slate-900 dark:text-slate-100">JF LoggR</h1>
    <nav class="flex gap-2 text-xs md:text-sm font-medium">
  <a routerLink="/today" class="inline-flex items-center px-3 h-8 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition">I dag</a>
  <a [routerLink]="['/summary', today()]" class="inline-flex items-center px-3 h-8 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition">Opsummering</a>
  <a routerLink="/settings" class="inline-flex items-center px-3 h-8 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition">Indstillinger</a>
      </nav>
      <div class="ml-auto flex items-center gap-3">
        @if(pendingCount() > 0) {
          <span class="inline-flex items-center rounded-full border border-indigo-600 px-3 py-1 text-xs font-medium bg-indigo-600 text-white shadow-sm" title="Ventende uloggede intervaller">{{pendingCount()}} ventende</span>
        }
  <div class="relative flex" (keydown.escape)="closeMenu()" data-menu-root>
          <button (click)="openDialog()"
            class="inline-flex items-center justify-center rounded-l-md text-sm font-semibold px-4 h-9 gap-2 bg-indigo-600 text-white shadow hover:bg-indigo-500 active:bg-indigo-700 disabled:opacity-40 transition"
            aria-label="Log ventende intervaller nu">
            Log nu
          </button>
          <button (click)="toggleMenu()" [attr.aria-expanded]="menuOpen()" aria-haspopup="menu"
            class="inline-flex items-center justify-center rounded-r-md text-sm font-semibold px-2 h-9 bg-indigo-600 text-white shadow hover:bg-indigo-500 active:bg-indigo-700 disabled:opacity-40 transition border-l border-indigo-500/40"
            aria-label="Flere log muligheder">
            <svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" class="w-4 h-4" aria-hidden="true"><path d="M6 8l4 4 4-4"/></svg>
          </button>
          @if(menuOpen()) {
            <div class="absolute top-full right-0 mt-1 w-48 rounded-md border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-800 shadow-lg z-10" role="menu" aria-label="Log muligheder">
              <button type="button" role="menuitem" (click)="openDialog(); closeMenu()"
                class="w-full text-left px-3 py-2 text-sm hover:bg-indigo-50 dark:hover:bg-slate-700 transition">
                Log nu
              </button>
              <button type="button" role="menuitem" (click)="openManualWithDate()"
                class="w-full text-left px-3 py-2 text-sm hover:bg-indigo-50 dark:hover:bg-slate-700 transition">
                Manuel registrering (Alt+M)
              </button>
            </div>
          }
        </div>
      </div>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 py-6">
    <router-outlet />
  </main>

  @if(dialogOpen()) {
    <log-dialog (closed)="dialogOpen.set(false)" />
  }
  @if(manualDialogOpen()) {
    <div class="fixed inset-0 z-50 flex items-start justify-center p-6 sm:p-10 overflow-y-auto bg-black/40 backdrop-blur-sm" role="presentation">
      <manual-log [dialogMode]="true" [initialDate]="manualDialogDate()" (closed)="manualDialogOpen.set(false)" class="w-full max-w-3xl" />
    </div>
  }
</div>
